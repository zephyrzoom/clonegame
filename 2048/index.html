<!DOCTYPE html>
<html>

<head>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.11.0/dist/phaser.min.js"></script>
</head>

<body>

    <script>
        var config = {
            type: Phaser.AUTO,
            width: 800,
            height: 600,
            backgroundColor: 0xfaf8ef,

            scene: {
                preload: preload,
                create: create,
                update: update
            },
        };

        var game = new Phaser.Game(config);

        function preload() {

            background = this.add.graphics();
            background.fillStyle(0xbbada0, 1.0);

            grid = this.add.graphics();
            grid.fillStyle(0xeee4da, 0.35);

            block2 = this.add.graphics();
            block2.fillStyle(0xeee4da, 1.0);

            cursors = this.input.keyboard.createCursorKeys();
        }

        function create() {

            background_width = 500;
            background_height = background_width;

            background.fillRoundedRect(0, 0, background_width, background_height, 6);
            grid_width = 15;
            block_width = (background_width - 5 * grid_width) / 4;
            block_heigth = (background_height - 5 * grid_width) / 4;

            for (let i = 0; i < 4; i++) {
                for (let j = 0; j < 4; j++) {
                    grid.fillRoundedRect(grid_width + j * (block_width + grid_width),
                        grid_width + i * (block_heigth + grid_width),
                        block_width,
                        block_heigth,
                        3);
                }
            }
            //////////////////////////////////////////////////////
            var Block = new Phaser.Class({

                Extends: Phaser.GameObjects.Graphics,

                initialize:

                    function Block(scene) {
                        Phaser.GameObjects.Graphics.call(this, scene, 0, 0, 'bullet');

                        this.speed = Phaser.Math.GetSpeed(600, 1);
                    },

                fire: function (x, y) {
                    this.setPosition(x, y);

                    this.setActive(true);
                    this.setVisible(true);
                },

                update: function (time, delta) {
                    this.x += this.speed * delta;

                    if (this.x > 820) {
                        this.setActive(false);
                        this.setVisible(false);
                    }
                }

            });

            blocks = this.add.group({
                classType: Block,
                maxSize: 30,
                runChildUpdate: true
            });
            ///////////////////////////////////////////////
            block2.fillRoundedRect(grid_width, grid_width, block_width, block_heigth, 3);
            down = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.DOWN);
            up = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.UP);
            left = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.LEFT);
            right = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.RIGHT);
        }

        function update() {
            if (Phaser.Input.Keyboard.JustDown(down)) {
                block = blocks.get();
                if (block)
                {
                    block.fire(100, 100);
                }
            } else if (Phaser.Input.Keyboard.JustDown(right)) {
                block2.x += 5;
            } else if (cursors.up.isDown) {} else if (cursors.down.isDown) {}
        }
    </script>

</body>

</html>